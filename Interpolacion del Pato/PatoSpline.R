x=c(
    40,33,30,28,27,26,24,22,19,14,11,10,10,11,29,33,57,59,61,63,65,67,71,72,72,71,70,70,69,69,68,68,67,67,66,65,65,64,64,63,62,62,61,61,62,73,77,79,82,83,86,87,89,91,92,93,94,96,96,98,98,99,100,100,103,104,105,106,106,107,108,108,108,110,110,110,111,113,115,131,138,139,156,163,164,175,175,171,163,153,150,148,145,143,139,136,131,127,122,115,106,85,84,77,66,60,55,53,48,41,40
    )
y=c(
    126,124,122,120,118,116,114,112,110,108,106,104,102,100,100,100,98,96,94,92,90,88,86,84,82,80,66,56,54,46,44,40,38,32,30,28,26,24,22,20,18,16,14,12,10,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,122,122,120,118,118,120,122,124,126,126
    )
plot(x,y, pch=19, cex=0.5, col = "red", asp=1,xlab="X", ylab="Y", main="Diagrama ")








cubicSpline<- function(x,y){
  a=rep(y)
  n=length(x)
  h<-(c(x,0)-c(0,x))[2:n]
  alph<-(3/c(1,h,1,1)*(c(a,1,1) - c(1,a,1)) - 3/c(1,1,h,1)*(c(1,a,1)-c(1,1,a)))[3:n]
  A <- c(1,rep(0,times=n-1))
  for (i in 1:(n-2)) {
    A <- rbind(A,c( rep(0,times=i-1) , c(h[i],2*(h[i]+h[i+1]),h[i+1]) , rep(0,times=n-i-2) ) )
  }
  A <- rbind(A,c(rep(0,times=n-1),1))
  b <- c(0,alph,0)
  c <- solve(A, b)
  b <- ((c(a,0) - c(0,a))/c(1,h,1) - c(1,h,1)/3*(c(c,0) + 2*c(0,c)))[2:n]
  d <- ((c(c,0) - c(0,c))/(3*c(1,h,1)))[2:n]
  ans = rbind(a[1:n-1],b,c[1:n-1],d)
}

draw<-function(x,y){
  t = 1:length(x)
  sx = cubicSpline(t,x)
  sy = cubicSpline(t,y)
  for (i in 1:(length(t)-1)) {
    dat<- data.frame(t=seq(t[i],t[i+1], by=0.1) )
    fx <- function(x) (sx[1,i] + sx[2,i]*(x-t[i]) + sx[3,i]*(x-t[i])^2 + sx[4,i]*(x-t[i]))
    fy <- function(x) (sy[1,i] + sy[2,i]*(x-t[i]) + sy[3,i]*(x-t[i])^2 + sy[4,i]*(x-t[i]))
    dat$y=fy(dat$t)
    dat$x=fx(dat$t)
    points(dat$x,dat$y,type='l', col='blue')
  }
}
draw(x,y)